<div class="p-6">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-bold text-blue-primary">
      Mes demandes de service
    </h2>
    <a
      [routerLink]="['/BO/mes-demandes/nouvelle-demande']"
      class="cursor-pointer flex items-center gap-2 bg-blue-primary text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors"
    >
      <i class="fas fa-plus"></i>
      Nouvelle demande
    </a>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center items-center h-64">
    <div
      class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-primary"
    ></div>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="bg-red-50 text-red-600 p-4 rounded-lg mb-4">
    {{ error }}
  </div>

  <!-- Demandes List -->
  <div *ngIf="!isLoading && !error" class="space-y-4">
    <div
      *ngFor="let demande of demandes"
      class="bg-white rounded-xl shadow-lg p-6"
    >
      <!-- En-tête de la demande -->
      <div class="flex justify-between items-start mb-4">
        <div>
          <h3 class="text-xl font-semibold text-blue-primary">
            {{ demande.vehicule.marque.libelle }}
            {{ demande.vehicule.modele.libelle }}
          </h3>
          <p class="text-gray-600">
            {{ demande.vehicule.immatriculation }}
          </p>
        </div>
        <span
          [class]="getStatusClass(demande.statut)"
          class="px-3 py-1 rounded-full text-sm font-medium"
        >
          {{ demande.statut }}
        </span>
      </div>

      <!-- Services demandés -->
      <div class="mb-4">
        <h4 class="font-medium text-gray-700 mb-2">Services demandés :</h4>
        <div class="flex flex-wrap gap-2">
          <span
            *ngFor="let service of demande.services"
            class="bg-blue-50 text-blue-primary px-3 py-1 rounded-full text-sm"
          >
            {{ service.titre }}
          </span>
        </div>
      </div>

      <!-- Informations de rendez-vous -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div>
          <p class="text-gray-600">
            Date de rendez-vous :
            <span class="font-medium">
              {{ demande.date_rdv | date : "dd/MM/yyyy" }}
            </span>
          </p>
        </div>
        <div>
          <p class="text-gray-600">
            Heure :
            <span class="font-medium">{{ demande.heure_rdv }}</span>
          </p>
        </div>
      </div>

      <!-- Estimation -->
      <div class="bg-gray-50 p-4 rounded-lg">
        <h4 class="font-medium text-gray-700 mb-2">Estimation :</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <p class="text-gray-600">
            Coût estimé :
            <span class="font-medium"
              >{{ demande.estimation.cout_estime }}€</span
            >
          </p>
          <p class="text-gray-600">
            Temps estimé :
            <span class="font-medium"
              >{{ demande.estimation.temps_estime }}h</span
            >
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div
    *ngIf="!isLoading && !error && demandes.length === 0"
    class="text-center text-gray-600 p-8"
  >
    Vous n'avez pas encore de demandes de service.
  </div>
</div>
